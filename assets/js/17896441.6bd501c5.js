"use strict";(self.webpackChunkphysical_ai_textbook=self.webpackChunkphysical_ai_textbook||[]).push([[401],{5813:(e,n,t)=>{t.d(n,{A:()=>p});var r=t(6540),a=t(4094),o=t(2444),i=t(467),s=t(4848),l="https://physical-ai-backend-production-b62f.up.railway.app";function c(e){var n=e.content,t=e.onTranslate,a=(0,r.useState)(!1),c=a[0],u=a[1],d=(0,r.useState)(!1),p=d[0],f=d[1],g=(0,r.useState)(""),h=g[0],m=g[1],b=(0,r.useState)(""),x=b[0],v=b[1];(0,r.useEffect)(function(){var e="translation_"+function(e){for(var n=0,t=0;t<e.length;t++){n=(n<<5)-n+e.charCodeAt(t),n&=n}return n.toString(36)}(n.substring(0,100)),t=sessionStorage.getItem(e);if(t)try{var r=JSON.parse(t),a=r.translated,o=r.timestamp;Date.now()-o<36e5&&m(a)}catch(i){console.error("Cache parse error:",i)}},[n]);var y=function(){var e=(0,i.A)((0,o.A)().m(function e(){var r,a,i,s,c;return(0,o.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!p){e.n=1;break}return f(!1),t&&t(""),e.a(2);case 1:if(!h){e.n=2;break}return f(!0),t&&t(h),e.a(2);case 2:return u(!0),v(""),e.p=3,e.n=4,fetch(l+"/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:n,target_language:"urdu"})});case 4:if((r=e.v).ok){e.n=5;break}throw new Error("Translation failed");case 5:return e.n=6,r.json();case 6:a=e.v,i=a.translated,m(i),f(!0),s="translation_"+function(e){for(var n=0,t=0;t<e.length;t++){n=(n<<5)-n+e.charCodeAt(t),n&=n}return n.toString(36)}(n.substring(0,100)),sessionStorage.setItem(s,JSON.stringify({translated:i,timestamp:Date.now()})),t&&t(i),e.n=8;break;case 7:e.p=7,c=e.v,v("Failed to translate content. Please try again."),console.error("Translation error:",c);case 8:return e.p=8,u(!1),e.f(8);case 9:return e.a(2)}},e,null,[[3,7,8,9]])}));return function(){return e.apply(this,arguments)}}();return(0,s.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,s.jsx)("button",{onClick:y,disabled:c,style:{padding:"8px 16px",backgroundColor:p?"#28a745":"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:c?"not-allowed":"pointer",fontSize:"14px",fontWeight:"500",display:"inline-flex",alignItems:"center",gap:"8px",transition:"background-color 0.2s"},onMouseEnter:function(e){c||(e.currentTarget.style.backgroundColor=p?"#218838":"#0056b3")},onMouseLeave:function(e){e.currentTarget.style.backgroundColor=p?"#28a745":"#007bff"},children:c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"spinner",style:{width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.6s linear infinite"}}),"Translating..."]}):p?(0,s.jsx)(s.Fragment,{children:"\u2713 Show Original"}):(0,s.jsx)(s.Fragment,{children:"\ud83c\udf10 Translate to Urdu"})}),x&&(0,s.jsx)("div",{style:{marginTop:"8px",padding:"8px 12px",backgroundColor:"#f8d7da",color:"#721c24",borderRadius:"4px",fontSize:"14px"},children:x}),(0,s.jsx)("style",{children:"\n        @keyframes spin {\n          to { transform: rotate(360deg); }\n        }\n      "})]})}var u="https://physical-ai-backend-production-b62f.up.railway.app";function d(e){var n=e.content,t=e.onPersonalize,a=(0,r.useState)(!1),l=a[0],c=a[1],d=(0,r.useState)(!1),p=d[0],f=d[1],g=(0,r.useState)(null),h=g[0],m=g[1],b=(0,r.useState)(""),x=b[0],v=b[1];if((0,r.useEffect)(function(){var e=localStorage.getItem("user");if(e)try{m(JSON.parse(e))}catch(n){console.error("Error parsing user data:",n)}},[]),!h)return null;var y=function(){var e=(0,i.A)((0,o.A)().m(function e(){var r,a,i,s;return(0,o.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n&&!(n.length<50)){e.n=1;break}return v("Content too short to personalize"),e.a(2);case 1:if(c(!0),v(""),e.p=2,r=localStorage.getItem("auth_token")){e.n=3;break}return v("Please sign in to personalize content"),e.a(2);case 3:return e.n=4,fetch(u+"/personalize",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+r},body:JSON.stringify({content:n,software_experience:h.software_experience||"beginner",hardware_experience:h.hardware_experience||"beginner",learning_goals:h.learning_goals||""})});case 4:if((a=e.v).ok){e.n=5;break}throw new Error("Failed to personalize content");case 5:return e.n=6,a.json();case 6:i=e.v,f(!0),t(i.personalized_content),e.n=8;break;case 7:e.p=7,s=e.v,v(s.message||"Personalization failed"),console.error("Personalization error:",s);case 8:return e.p=8,c(!1),e.f(8);case 9:return e.a(2)}},e,null,[[2,7,8,9]])}));return function(){return e.apply(this,arguments)}}();return(0,s.jsxs)("div",{className:"personalize-button-container",children:[p?(0,s.jsxs)("div",{className:"personalize-info",children:[(0,s.jsxs)("span",{className:"personalize-badge",children:["\u2713 Personalized for your ",h.software_experience," level"]}),(0,s.jsx)("button",{onClick:function(){f(!1),t("")},className:"reset-button",children:"Reset to Original"})]}):(0,s.jsx)("button",{onClick:y,disabled:l,className:"personalize-button",children:l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"spinner"}),"Personalizing for ",h.name,"..."]}):(0,s.jsx)(s.Fragment,{children:"\ud83c\udfaf Personalize Content for Me"})}),x&&(0,s.jsx)("div",{className:"personalize-error",children:x})]})}function p(e){var n=(0,r.useState)(""),t=n[0],o=n[1],i=(0,r.useState)(""),l=(i[0],i[1]),u=(0,r.useState)(!1),p=(u[0],u[1]),f=(0,r.useState)(!1),g=(f[0],f[1]);(0,r.useEffect)(function(){var e=document.querySelector(".markdown");e&&o(e.textContent||"")},[e]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"translate-button-wrapper",children:[(0,s.jsx)(d,{content:t,onPersonalize:function(e){if(e){g(!0);var n=document.querySelector(".markdown");if(n){n.getAttribute("data-original-html")||n.setAttribute("data-original-html",n.innerHTML);var t=document.createElement("div");t.className="personalized-content";var r=e.split("\n\n").map(function(e){if(e.trim().startsWith("```")){var n=e.match(/```(\w+)?\n([\s\S]*?)```/);return n?'<pre><code class="language-'+(n[1]||"text")+'">'+n[2]+"</code></pre>":"<pre>"+e.replace(/```/g,"")+"</pre>"}return"<p>"+e.replace(/`([^`]+)`/g,"<code>$1</code>")+"</p>"}).join("");t.innerHTML=r,n.innerHTML="",n.appendChild(t)}}else{g(!1);var a=document.querySelector(".markdown");if(a){var o=a.getAttribute("data-original-html");o&&(a.innerHTML=o)}}}}),(0,s.jsx)(c,{content:t,onTranslate:function(e){if(e){l(e),p(!0);var n=document.querySelector(".markdown");if(n){n.getAttribute("data-original-html")||n.setAttribute("data-original-html",n.innerHTML);var t=document.createElement("div");t.className="translated-content";var r=e.split("\n\n").map(function(e){return e.trim().startsWith("```")||e.includes("`")?'<pre style="direction: ltr; text-align: left;">'+e+"</pre>":"<p>"+e+"</p>"}).join("");t.innerHTML=r,n.innerHTML="",n.appendChild(t)}}else{p(!1);var a=document.querySelector(".markdown");if(a){var o=a.getAttribute("data-original-html");o&&(a.innerHTML=o)}}}})]}),(0,s.jsx)(a.A,Object.assign({},e))]})}}}]);